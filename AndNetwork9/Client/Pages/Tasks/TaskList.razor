@page "/Task"
<BaseBodyWithAside>
    <Title>
        Задачи
    </Title>
    <Main>
        @if (CurrentViewType != ViewType.Unassigned)
        {
            <div class="accordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" data-bs-target="#collapseOne" data-bs-toggle="collapse" type="button">
                            Активные
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse show" id="collapseOne">
                        <div class="accordion-body" style="max-height: 50vh; overflow-y: scroll">
                            @if (AssigneeActive is not null)
                            {
                                <Virtualize Items="AssigneeActive" Context="task" OverscanCount="2">
                                    <TaskShortCard Task="task"/>
                                </Virtualize>
                            }
                            else
                            {
                                <LoadingSpinner/>
                            }
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" data-bs-target="#collapseTwo" data-bs-toggle="collapse" type="button">
                            На анализе у инициатора
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapseTwo">
                        <div class="accordion-body" style="max-height: 50vh; overflow-y: scroll">
                            @if (AssigneeOnInitiator is not null)
                            {
                                <Virtualize Items="AssigneeOnInitiator" Context="task" OverscanCount="2">
                                    <TaskShortCard Task="task"/>
                                </Virtualize>
                            }
                            else
                            {
                                <LoadingSpinner/>
                            }
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" data-bs-target="#collapseThree" data-bs-toggle="collapse" type="button">
                            Звершенные
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapseThree">
                        <div class="accordion-body" style="max-height: 50vh; overflow-y: scroll">
                            @if (AssigneeEnd is not null)
                            {
                                <Virtualize Items="AssigneeEnd" Context="task" OverscanCount="2">
                                    <TaskShortCard Task="task"/>
                                </Virtualize>
                            }
                            else
                            {
                                <LoadingSpinner/>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="accordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" data-bs-target="#collapseOne" data-bs-toggle="collapse" type="button">
                            Задачи без исполнителя
                        </button>
                    </h2>
                    <div class="accordion-collapse collapse show" id="collapseOne">
                        <div class="accordion-body" style="max-height: 50vh; overflow-y: scroll">
                            @if (AssigneeActive is not null)
                            {
                                <Virtualize Items="AssigneeActive" Context="task" OverscanCount="2">
                                    <TaskShortCard Task="task"/>
                                </Virtualize>
                            }
                            else
                            {
                                <LoadingSpinner/>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }

    </Main>
    <Aside>
        <div class="d-grid mb-3">
            <a class="btn btn-success mb-1" href="/task/new">Создать задачу</a>
        </div>
        <h5>Параметры отображения</h5>
        <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" value="@InitiatorMode" id="flexCheckDefault">
            <label class="form-check-label" for="initiatorModeCheckbox">
                Режим инициатора
            </label>
        </div>
        <EditForm Model="@CurrentViewTypeInt">

            <div class="form-check">
                <input Name="Me" class="form-check-input" type="radio" id="viewMode1" value="0" checked="@(CurrentViewTypeInt == 0)" @onclick="() => CurrentViewTypeInt = 0"/>
                <label class="form-check-label" for="viewMode1">
                    Мои задачи
                </label>
            </div>
            <div class="form-check">
                <input Name="SquadPart" class="form-check-input" type="radio" id="viewMode2" value="1" checked="@(CurrentViewTypeInt == 1)" @onclick="() => CurrentViewTypeInt = 1"/>
                <label class="form-check-label" for="viewMode2">
                    Задачи отделения
                </label>
            </div>
            <div class="form-check">
                <input Name="Squad" class="form-check-input" type="radio" id="viewMode3" value="2" checked="@(CurrentViewTypeInt == 2)" @onclick="() => CurrentViewTypeInt = 2"/>
                <label class="form-check-label" for="viewMode3">
                    Задачи отряда
                </label>
            </div>
            <div class="form-check">
                <input Name="Direction" class="form-check-input" type="radio" id="viewMode4" value="3" checked="@(CurrentViewTypeInt == 3)" @onclick="() => CurrentViewTypeInt = 3"/>
                <label class="form-check-label" for="viewMode4">
                    Задачи направления
                </label>
            </div>
            <div class="form-check">
                <input Name="Unassigned" class="form-check-input" type="radio" id="viewMode5" value="4" checked="@(CurrentViewTypeInt == 4)" @onclick="() => CurrentViewTypeInt = 4"/>
                <label class="form-check-label" for="viewMode5">
                    Задачи без исполнителя
                </label>
            </div>
        </EditForm>
    </Aside>
    <Footer>

    </Footer>
</BaseBodyWithAside>